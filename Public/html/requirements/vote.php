<?php	require_once ("tool_vars.php");	// Form to allow user to vote	$PAGE_NAME = "Voting Form";	// connect to database	require "mysqlconnect.php";	// get the passkey from the cookie if it exists	$PASSKEY = $_COOKIE["SESSION_ID"];	// check the passkey	$USER_PK = 0;	if (isset($PASSKEY)) {		$sql1 = "SELECT users_pk FROM sessions WHERE passkey = '$PASSKEY'";		$result = mysql_query($sql1) or die('Query failed: ' . mysql_error());		$count = mysql_num_rows($result);		$row = mysql_fetch_assoc($result);		if( empty($result) || ($count < 1)) {			// no valid key exists, user not authenticated			// redirect to the login page			header('location:'.$ACCOUNTS_PATH.'login.php?referrer='.$TOOL_PATH.'/vote.php');			mysql_free_result($result);			exit;		} else {			// authenticated user			$USER_PK = $row["users_pk"];			mysql_free_result($result);		}	}	// if we get here, user should be authenticated?><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title><?= $TOOL_NAME ?> - <?= $PAGE_NAME ?></title><link href="./requirements_vote.css" rel="stylesheet" type="text/css"><script><!--function focus(){document.filter.searchtext.focus();}function clearRadio(num) {	var item = document.getElementsByName('vr'+num);	for (i=0;i<item.length;i++)		item[i].checked=false;	var item = document.getElementById('vb'+num);	item.className='clear';	//document.voteform.debugtest.value='ARG:' + item;}function setUnsaved(num) {	var item = document.getElementById('vb'+num);	item.className='unsaved';	var sbutton = document.getElementById('vs'+num);	sbutton.disabled=false;	//document.voteform.debugtest.value='UGH:' + item;}// --></script></head><body onLoad="focus();"><?php	// get the authenticated user information	$authsql = "SELECT * FROM users WHERE pk = '$USER_PK'";	$result = mysql_query($authsql) or die('Query failed: ' . mysql_error());	$USER = mysql_fetch_assoc($result);?><? // Include the HEADER -AZinclude 'header.php'; ?><?php	// fetching all data I think? -AZ	$sql="Select * from requirements_data";	$result= mysql_query($sql) or die('Query failed: ' . mysql_error());	$resultsnumber=mysql_num_rows($result);?>  <div style="background:#ECECEC;border:1px solid #ccc;padding:3px;"><FORM ACTION="vote.php" METHOD="GET" name="filter" style="margin:0px;"><strong> Filter: </strong> &nbsp;&nbsp;<select name="type">                <option value="">-- voting status --</option>                <option value="all">show all items</option>                <option value="done">show all items I've voted on</option>                <option value="open">show all items I need to vote on</option>                    <option value="show_critical"                                > show items I've marked as Critical </option>                   <option value="show_essential"                                > show items I've marked as Essential </option>                    <option value="show_desirable"                                > show items I've marked as Desirable</option>                    <option value="show_na"                                > show items I've marked as  Not Applicable </option>            </select>&nbsp; &nbsp;    <select  name="components"  id="components">                    <option value="">-- component type --</option>                <option value="all"                        >show all components</option>                            <option value="10360" title=" New Tool "                                > New Tool</option>                    <option value="10290" title="Account  "                                >Account </option>                    <option value="10291" title="Aliases (Admin Site Management) "                                >Aliases (Admin Site Management)</option>                    <option value="10292" title="Announcements  "                                >Announcements </option>                    <option value="10293" title="Assignments  "                                >Assignments </option>                    <option value="10294" title="Attachment Widget  "                                >Attachment Widget </option>                    <option value="10295" title="CRUD  "                                >CRUD </option>                    <option value="10296" title="Calendar Widget  "                                >Calendar Widget </option>                    <option value="10297" title="Chat Room  "                                >Chat Room </option>                    <option value="10298" title="Database  "                                >Database </option>                    <option value="10299" title="Discussion  "                                >Discussion </option>                    <option value="10300" title="Documentation (other than Help) "                                >Documentation (other than Help)</option>                    <option value="10301" title="Drop box  "                                >Drop box </option>                    <option value="10302" title="E-mail Archive "                                >E-mail Archive</option>                    <option value="10303" title="Gateway  "                                >Gateway </option>                    <option value="10304" title="Global  "                                >Global </option>                    <option value="10305" title="Gradebook  "                                >Gradebook </option>                    <option value="10306" title="Help  "                                >Help </option>                    <option value="10307" title="Home  "                                >Home </option>                    <option value="10308" title="Install  "                                >Install </option>                    <option value="10309" title="JSF  "                                >JSF </option>                    <option value="10310" title="Licensing  "                                >Licensing </option>                    <option value="10311" title="MOTD  "                                >MOTD </option>                    <option value="10312" title="Membership  "                                >Membership </option>                    <option value="10313" title="Memory (Admin Site Management) "                                >Memory (Admin Site Management)</option>                    <option value="10314" title="My Workspace  "                                >My Workspace </option>                    <option value="10315" title="News (RSS) "                                >News (RSS)</option>                    <option value="10316" title="OSIDs  "                                >OSIDs </option>                    <option value="10317" title="On-Line (Admin Site Management) "                                >On-Line (Admin Site Management)</option>                    <option value="10318" title="Page Wrapper Widget  "                                >Page Wrapper Widget </option>                    <option value="10319" title="Permission Widget  "                                >Permission Widget </option>                    <option value="10320" title="Portal  "                                >Portal </option>                    <option value="10321" title="Preferences  "                                >Preferences </option>                    <option value="10322" title="Presence  "                                >Presence </option>                    <option value="10323" title="Presentation  "                                >Presentation </option>                    <option value="10324" title="Profile  "                                >Profile </option>                    <option value="10325" title="Providers  "                                >Providers </option>                    <option value="10326" title="Quartz Scheduler  "                                >Quartz Scheduler </option>                    <option value="10327" title="Realms (Admin Site Management) "                                >Realms (Admin Site Management)</option>                    <option value="10328" title="Resources  "                                >Resources </option>                    <option value="10329" title="Roster  "                                >Roster </option>                    <option value="10330" title="Rwiki  "                                >Rwiki </option>                    <option value="10331" title="SUTool  "                                >SUTool </option>                    <option value="10332" title="Sakai APIs  "                                >Sakai APIs </option>                    <option value="10333" title="Sakai Application Framework  "                                >Sakai Application Framework </option>                    <option value="10334" title="Samigo - Authoring  "                                >Samigo - Authoring </option>                    <option value="10335" title="Samigo - Delivery  "                                >Samigo - Delivery </option>                    <option value="10336" title="Samigo - Global  "                                >Samigo - Global </option>                    <option value="10337" title="Samigo - Grading  "                                >Samigo - Grading </option>                    <option value="10338" title="Samigo - Question Pools  "                                >Samigo - Question Pools </option>                    <option value="10339" title="Samigo - Templates  "                                >Samigo - Templates </option>                    <option value="10340" title="Schedule  "                                >Schedule </option>                    <option value="10341" title="Section Info  "                                >Section Info </option>                    <option value="10342" title="Site Archive (Admin Site Management)  "                                >Site Archive (Admin Site Management) </option>                    <option value="10343" title="Site Info  "                                >Site Info </option>                    <option value="10344" title="Sites (Admin Site Management)  "                                >Sites (Admin Site Management) </option>                    <option value="10345" title="Sites (Gateway) "                                >Sites (Gateway)</option>                    <option value="10346" title="Skins (CSS) "                                >Skins (CSS)</option>                    <option value="10347" title="Style Guide  "                                >Style Guide </option>                    <option value="10348" title="Syllabus  "                                >Syllabus </option>                    <option value="10349" title="Tab Management  "                                >Tab Management </option>                    <option value="10350" title="Tests &amp; Quizzes (Samigo) "                                >Tests &amp; Quizzes (Samigo)</option>                    <option value="10351" title="Twin Peaks  "                                >Twin Peaks </option>                    <option value="10353" title="Users (Admin User Management) "                                >Users (Admin User Management)</option>                    <option value="10354" title="WYSIWYG Widget  "                                >WYSIWYG Widget </option>                    <option value="10355" title="Web Content  "                                >Web Content </option>                    <option value="10356" title="Web Services  "                                >Web Services </option>                    <option value="10357" title="WebDAV  "                                >WebDAV </option>                    <option value="10358" title="Worksite Information  "                                >Worksite Information </option>                    <option value="10359" title="Worksite Setup  "                                >Worksite Setup </option>            </select> <select  name="audience"  id="audience">                     <option value="">-- audience --</option>                <option value="all"                        >show all audiences</option>                            <option value="10360" title="Students "                                > Students</option>                    <option value="10290" title="Instructors  "                                >Instructors </option>                    <option value="10291" title="Researchers "                                >Researchers</option>                    <option value="10292" title="Staff(administrative)  "                                >Announcements </option>                    <option value="10293" title="Sakai administrators  "                                >Sakai Administrators </option>                    <option value="10294" title="Sakai developers  "                                >Sakai Developers </option>               </select>&nbsp; &nbsp;            <!--audience -->        <input type="text" name="searchtext" length="20">        <input type="submit" name="search" value="Search">	</FORM>	</div><br/><form name="voteform" method="post" action="vote.php" style="margin:0px;"><!--<input type="text" name="debugtest">--><table width=100% border=0 cellspacing=0><tr class='tableheader'><td width='10%'>&nbsp;VOTE</td><td width='5%' align="center">Req#</td><td width='35%'>Summary</td><td width='50%'>Description</td></tr><?phpwhile($links=mysql_fetch_array($result)) {	$line++;	$pk=$links["pk"];	$key=$links["jirakey"];	$summary=$links["summary"];	$description=$links["description"];	$audience=$links["audience"];	$component=$links["component"];	$toolname=$links["toolname"];	$need=$links["need"];	$timeframe=$links["timeframe"];	$linestyle = "oddrow";	if ($line % 2 == 0) {		$linestyle = "evenrow";	} else {		$linestyle = "oddrow";	}	/**	Should set the class of the TD depending on the state of that item -AZ	saved = item has been voted on and saved	unsaved = item has changed	clear = item has no items selected (may have been saved already)	Clear button should be disabled for saved items, Save button should be disabled for saved items	**/?>	<tr id="<?= $linestyle ?>" valign="top">		<td id="vb<?= $pk ?>" nowrap='y' style='border-right:1px dotted #ccc;border-bottom:1px solid black;' rowspan="2">			<input name="vr<?= $pk ?>" type="radio" value="3" onChange="setUnsaved('<?= $pk ?>')">critical<br />			<input name="vr<?= $pk ?>" type="radio" value="2" onChange="setUnsaved('<?= $pk ?>')">essential<br />			<input name="vr<?= $pk ?>" type="radio" value="1" onChange="setUnsaved('<?= $pk ?>')">desirable<br />			<input name="vr<?= $pk ?>" type="radio" value="0" onChange="setUnsaved('<?= $pk ?>')">not&nbsp;applicable&nbsp;<br />			<br/>			<input type="button" name="clear" value="Clear"				onClick="clearRadio('<?= $pk ?>')">			<input id="vs<?= $pk ?>" type="submit" name="submit" value="Save" disabled='y'>		</td>		<td nowrap='y'>			&nbsp;			<a href='<?= $JIRA_REQ ?><?= $key ?>' title='link to Jira requirement <?= $key ?>'><?= $key ?></a>			&nbsp;		</td>		<td><?= $summary ?></td>		<td rowspan="2" style="padding:2px;border-bottom:1px solid black;">			<?= $description ?>		</td>	</tr>	<tr id="<?= $linestyle ?>" valign="top">		<td colspan="2" style="border-bottom:1px solid black;">			<table>			<tr>				<td align=right><b>Component:</b></td>				<td align="left"><?= $component ?></td>			</tr>			<tr>				<td align=right><b>Audience:</b></td>				<td align="left"><?= $audience ?></td>			</tr>			<tr>				<td align=right><b>Timeframe:</b></td>				<td align="left"><?= $timeframe ?></td>			</tr>			</table>		</td>	</tr><?php } //end of while ?></table></form><?php // Include the FOOTER -AZinclude 'footer.php'; ?></body></html>