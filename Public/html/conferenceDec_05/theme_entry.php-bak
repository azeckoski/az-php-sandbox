<html>
<head>
<title>Entry form
</title>
</head>
<body>

<div><br>
<?php 
if (isset($_POST['idea'])) {



$uploadDir = '/afs/umich.edu/group/acadaff/sakai/Public/html/conferenceDec_05/theme/graphics/';
$uploadFile = $uploadDir . ($_FILES['userfile']['name']);
$filename= '../conferenceDec_05/theme/graphics/' . $_FILES['userfile']['name'];
// get client side file name 

$userfile_error = $_FILES['userfile']['error'];

// userfile_error was introduced at PHP 4.2.0
// use this code with newer versions

if ($userfile_error > 0) {
echo '<div id=box style=height:300px;><div class=errors><p><strong>Upload Incomplete</strong></p><p>';
switch ($userfile_error)
{ case 1:
echo 'File exceeded upload_max_filesize</p></div></div>';
break;
case 2:
echo 'File exceeded max_file_size</p></div></div>';
break;
case 3:
echo 'File only partially uploaded</p></div></div>';
break;
case 4:
require "../includes/mysqlconnectWeb.php";


$entry="INSERT INTO contest values ('',
		'$_POST[name]', 
		'$_POST[email1]',
		'$_POST[email2]',
		'$_POST[idea]',
		'none'
		)";
		
$result = mysql_query($entry) or die(mysql_error("
		<p>There was a problem with the submission form submission.
		Please try to submit the entry again. 
		 If you continue to have prolems, please report the problem to the 
		 <a href=\"mailto:shardin@umich.edu\">sakaiproject.org webmaster</a>."));

echo "<p>entry successful</p>";



break;
}
exit;
}



$fileNameParts = explode(".", $_FILES['userfile']['name']); 

$fileExtension = end($fileNameParts); 
// part behind last dot 


if ($fileExtension != "jpg" && $fileExtension != "JPEG" && $fileExtension != "JPG" && $fileExtension != "gif" && $fileExtension != "GIF" && $fileExtension != "PNG" && $fileExtension != "png") 
die("<div id=box style=height:300px;><div class=errors><p><strong>Upload Incomplete</strong></p>
<p>Error -  Image format must be jpg, gif, png, or bmp</p></div></div>"); 






if (is_uploaded_file($_FILES['userfile']['tmp_name'])) {
echo '<div id=box style=height:300px;><div class=errors><p><strong>Upload Incomplete</strong></p><p>';

   echo "<blockquote><p>File ". $_FILES['userfile']['name'] ." uploaded successfully.</p>";
   
   
   if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadFile))       {
   
require "../includes/mysqlconnectWeb.php";


$entry="INSERT INTO contest values ('',
		'$_POST[name]', 
		'$_POST[email1]',
		'$_POST[email2]',
		'$_POST[idea]',
		'$filename'
		)";
		
$result = mysql_query($entry) or die(mysql_error("
		<p>There was a problem with the submission form submission.
		Please try to submit the entry again. 
		 If you continue to have prolems, please report the problem to the 
		 <a href=\"mailto:shardin@umich.edu\">sakaiproject.org webmaster</a>."));

echo "<p>entry successful</p>";

}

}

}

else {
 //show form 

?>
<form action="<?php echo $_SERVER['PHP_SELF'];?>" method="post" enctype="multipart/form-data">
<table cellpadding="1" bordercolor="#cccccc" border="0">
  <tbody><tr><td width="213" align="right">
<div align="right"><strong>Name: &nbsp;&nbsp;</strong></div></td><td width="10">&nbsp;</td><td width="392">
<input type="text" value="" maxlength="40" size="20" name="name"></td><td width="245" bordercolor="#E4E4E4" bgcolor="#FFFFFF">
<div align="center"><u><em><strong>Previous Conferences</strong></em></u></div></td></tr><tr><td align="right">
<div align="right"><strong>Email: *&nbsp; <br>
</strong></div></td><td>&nbsp;</td><td>
<input type="text" value="" maxlength="70" size="20" name="email1"> </td><td rowspan="5" bordercolor="#E4E4E4" bgcolor="#FFFFFF">
<div align="center"><a href="http://www.sakaiproject.org/index.php?option=com_content&amp;task=view&amp;id=243&amp;Itemid=477" title="3rd Sakai SEPP Conference June 2005"><img style="margin: 0px;" width="77" height="100" border="0" align="bottom" src="http://www.sakaiproject.org/images/stories/conferenceLogos/csw05_sakai_sm.jpg" alt="" title=""></a><br>
<a href="http://sakaiproject.org/conferenceDec_04" title="2nd Sakai SEPP Conference December 2004"><img style="margin: 0px;" width="80" height="73" border="0" align="bottom" title="" alt="" src="http://www.sakaitest.org/images/stories/conferenceLogos/2nd_conf_logo.jpg"></a><br>
<a href="http://sakaiproject.org/conferenceJune_04" title="1st Sakai SEPP Conference, June 2004"><img style="margin: 0px;" width="80" height="69" border="0" align="bottom" title="" alt="" src="http://www.sakaitest.org/images/stories/1st_conf.jpg"></a></div></td></tr><tr><td align="right">
<div align="right"><strong>Confirm Email: *&nbsp; <br>
</strong></div></td><td>&nbsp;</td><td>
<input type="text" value="" maxlength="70" size="20" name="email2"> </td></tr><tr><td align="right">
<div align="right"><strong>Theme/Logo Idea </strong></div></td><td>&nbsp;</td><td>
<input type="text" size="30" maxlength="200" name="idea"></td></tr><tr><td align="right">
<div align="right">
<p><strong>Accompanying<br>
</strong><strong>graphic </strong>(if any) </p> </div></td><td>&nbsp;</td><td>
<input type="file" name="userfile"> </td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td valign="top"><br>
<input type="submit" value="Submit Entry"> <br>
</td></tr></tbody></table>
</form><br>
<p class="small">If you experience problems using this form, you
may submit your ideas directly to <a href="mailto:shardin@umich.edu?subject=Austin%20Logo%20Idea">shardin@umich.edu</a></p></div>
<?php 

}

?>

</body>
</html>